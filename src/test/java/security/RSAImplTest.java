package security;

import junit.framework.TestCase;

import javax.crypto.BadPaddingException;
import java.math.BigInteger;

/**
 * User: xuefeng
 * Date: 14-3-27
 * Time: 下午8:49
 */
public class RSAImplTest extends TestCase {
	public void testRSAImpl() throws BadPaddingException {
		BigInteger p = new BigInteger("11178073924125056989034750758284571942447144247908614357652605463924807583024360342964137919744744627131504397986143861319535088009283464462762246095416723");
		BigInteger q = new BigInteger("8307042644922826031932122929626257950995059708311449635674446103423245198547834465527005487751962421599601098942727416998387498670317420071683392563803703");

		RSAImpl rsaImpl = RSAImpl.getInstance(p, q);

		String input = "hello world!";
		byte[] encrypted = rsaImpl.encrypt(input.getBytes());
		assertEquals(new BigInteger("125880855058427190094302833236100965517972734825591569339475873249837644238784902022281659585405762535720494622982367796294080367784003622751546170012893279947455740460119766086689601315674260125254276053353563449598642510879035090846569410217361967299455932342788984199888574911389846548405789495207385683364"), new BigInteger(encrypted));

		byte[] decrypted = rsaImpl.decrypt(encrypted);
		assertEquals(input, new String(decrypted));
	}
}

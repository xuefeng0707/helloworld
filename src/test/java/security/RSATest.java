package security;

import junit.framework.TestCase;

/**
 * User: xuefeng
 * Date: 14-3-25
 * Time: 下午11:28
 */
public class RSATest extends TestCase {

	/**
	 * example:
	 * n : 130439847000892024375508339310021302411039358219442220719512863631125301145806317917705952383547946789283061769348813217282466675910320532582508143897675813616365666457135415916756535342387277932381888269736060630740378825603071505210578498454984486710713674100159559585510254297406413703334386520325541380117
	 * e : 65537
	 * d : 839916618618130739680859959852129173100059648268987246038641201952101516449185439694705462652505203855493111779074403431545553461924642030453307852431743651754048916460558244878733876638320794081730017235380495359448471897853118044677606856066868870749712260442220429423814239976985201195487883468915283849
	 * p : 11641043165523098214624136354728164704988164479837375664840511837917304154009391691297836366925221711891198191856542516232070913747687502322916241010576459
	 * q : 11205168226436227709125279938734493592181813758812561505922048032607897022241567616298898109539729940426474001351661125506005232762862399150289150168344863
	 * pe : 9104550857305299986068775762306812003655619676564755244407435727545161649481352364631478381059341887581170113370932446625681047743491742169548770396556411
	 * qe : 2035453678620066388103459994669181473288745179038765044600790115937516426595447800052464745015342248512705387583983485651601267925627917998751733108841503
	 * coeff : 4771663278551225483033069469061325907910196419941102902478154664041589870773892769007038457223439553188257924610601836035134877481100533183955421409763884
	 * algid : RSA
	 *
input:
hello world!

BASE64 of encrypted by public key:
oXaFj+cikEwuilWy4YIXhau9qIJh88hnLiwX3dJ4F+5P7VMlMvg9es2P17GoVG0ZfhWAskitgy9d
/7PCTXeU7iswrHYmZbyOJBemVDf2IQavrR/+01edu8lqWtbbvT4DQMz/huFn6ou+NlG9POs2lGlC
idZY+PJVFGv95Y2M1UI=

decrypted by private key:
hello world!

BASE64 of encrypted by private key:
MaQkkbgclGD+k2cyobjaUxpyg8DpttQ5Xy1YdK3OaX/Sj9YK4w30dqg0ERg8/xtCyzIMA0CV/KgV
zYeSZXs0rBrdOroI25xzf2dFBbXSr0CW10J9ib8Oy6csV513Cb4pMyWy6eL0umipKvZqt8LhfNZs
C4E0Kr8mcJoW4WA8pJ4=

decrypted by public key:
hello world!

	 * @throws Exception
	 */
	public void testEncrypt() throws Exception {
		String msg = "hello world!";
		RSA rsa = RSA.getInstance();
		byte[] input = msg.getBytes();

		// 公钥加密 -> 私钥解密
		byte[] encrypted = rsa.encryptByPublicKey(input);
		byte[] decrypted = rsa.decryptByPrivateKey(encrypted);
		assertEquals(msg, new String(decrypted));

		// 私钥加密 -> 公钥解密
		encrypted = rsa.encryptByPrivateKey(input);
		decrypted = rsa.decryptByPublicKey(encrypted);
		assertEquals(msg, new String(decrypted));
	}
}
